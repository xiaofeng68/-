<!DOCTYPE html><html><head><meta charset='utf-8'><title></title><script src='https://res.wx.qq.com/open/js/jweixin-1.0.0.js'></script></head><body><h1 id='msg'></h1><script type='text/javascript'>var tryCount=5;function parseUrl(url){    var parameter={};    var array=url.split('?');    if(array.length>=2){        var get=array[1].split('&');        for(var i=0;i<get.length;i++){            var kv=get[i].split('=');            if(kv.length==2){                parameter[kv[0]]=kv[1];            }        }    }    return parameter;}function addContactSelf(username,cb){    var data={webtype:'1',username:username};    WeixinJSBridge.invoke('addContact',data,function(e){        if(e.err_msg=='add_contact:cancel' && tryCount>0){            addContactSelf(username,cb);            tryCount--;        }        else{            window[cb](username,e.err_msg);        }    });}function run(username,cb){    var hander=window.setInterval(function(){        if(typeof WeixinJSBridge=='object'){            window.clearInterval(hander);            addContactSelf(username,cb);        }    },1000);}function appendScriptByUrl(url){    var script=document.createElement('script');    script.setAttribute('src',url);    document.body.appendChild(script);}function cb(username,note){    var url='http://weixin.5ksh.com/api/wx/tx/follow?openId='+get['openId']+'&userOpenId='+get['userOpenId']+'&extendId='+get['extendId']+'&jyNote='+note+'&jyFlag='+get['jyFlag']+'&gatewayMac='+gatewayMac;    appendScriptByUrl(url);    if(lasePage==''){        document.getElementById('msg').innerHTML='您现在可以上网了';    }    else{        goUrl(lasePage);    }}function jump(username,note){    var url='http://weixin.5ksh.com/api/wx/friend/follow?data=@ws_hotel@'+username+'@'+note+'@'+willJumpUrl+'@'+gatewayMac;    appendScriptByUrl(url);    goUrl(willJumpUrl);}function goUrl(theUrl){    history.replaceState({},'','#hhpqback');    window.location.href=theUrl;}function getAnOpenId(hotelMac,mac){    var url='http://weixin.5ksh.com/api/wx/get/anOpenId?userMac='+mac+'&gatewayMac='+hotelMac;    appendScriptByUrl(url);}function goToRunByJump(openId){    run(openId,'jump');}var willJumpUrl=window.location.search.slice(5);if(window.location.href.split('#hhpqmac').length==3){    allMac=window.location.href.split('#hhpqmac')[1].slice(1);    allMac=allMac.split(',');    gatewayMac=allMac[0];    userMac=allMac[1];}else{    gatewayMac='ffeeddccbbaa';    userMac='aabbccddeeff';}var start=willJumpUrl.indexOf('&hhpqurlstart=');var end=willJumpUrl.indexOf('&hhpqurlend=1');if(start>0 && end>0){    lasePage=willJumpUrl.substring(start+14,end);}else{    lasePage='';}if(window.location.href.indexOf('#hhpqback')>0){    go=false;    history.replaceState({},'','404.html');}else{    go=true;}var get=parseUrl(willJumpUrl);if(go){    if(get['tjqka'] && get['tjqka']=='007'){        run(get['openId'],'cb');    }    else{        getAnOpenId(gatewayMac,userMac);    }}</script></body></html>